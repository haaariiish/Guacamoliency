your current dir is: /workdir/simlab_team/prabakaran/GuacaMoliency
your workdir is: /scratch/simlab_team/106156.torque1.cluster.lbt/
number of nodes: 1
number of cores: 48
your execution environment: node081.cluster.lbt
cuda:0
Training start
{'loss': 4.0229, 'grad_norm': 328543.375, 'learning_rate': 0.0, 'epoch': 0.0}
{'loss': 3.4627, 'grad_norm': 33151.859375, 'learning_rate': 1.3053415175656262e-05, 'epoch': 0.54}
{'eval_loss': 7.12083625793457, 'eval_runtime': 971.285, 'eval_samples_per_second': 345.268, 'eval_steps_per_second': 21.58, 'epoch': 0.54}
{'loss': 2.938, 'grad_norm': 88861.6328125, 'learning_rate': 2.611336032388664e-05, 'epoch': 1.07}
{'eval_loss': 6.344899654388428, 'eval_runtime': 966.9335, 'eval_samples_per_second': 346.822, 'eval_steps_per_second': 21.677, 'epoch': 1.07}
{'loss': 2.644, 'grad_norm': 89635.984375, 'learning_rate': 3.9173305472117015e-05, 'epoch': 1.61}
{'eval_loss': 5.6718621253967285, 'eval_runtime': 969.2423, 'eval_samples_per_second': 345.996, 'eval_steps_per_second': 21.625, 'epoch': 1.61}
{'loss': 2.3863, 'grad_norm': 90219.4140625, 'learning_rate': 5.223325062034739e-05, 'epoch': 2.15}
{'eval_loss': 5.135448455810547, 'eval_runtime': 956.6202, 'eval_samples_per_second': 350.561, 'eval_steps_per_second': 21.91, 'epoch': 2.15}
{'loss': 2.1864, 'grad_norm': 77403.5625, 'learning_rate': 6.529319576857777e-05, 'epoch': 2.69}
{'eval_loss': 4.747098922729492, 'eval_runtime': 971.9168, 'eval_samples_per_second': 345.044, 'eval_steps_per_second': 21.566, 'epoch': 2.69}
{'loss': 2.0471, 'grad_norm': 99382.6875, 'learning_rate': 7.835314091680814e-05, 'epoch': 3.22}
{'eval_loss': 4.487837314605713, 'eval_runtime': 970.524, 'eval_samples_per_second': 345.539, 'eval_steps_per_second': 21.597, 'epoch': 3.22}
{'loss': 1.9474, 'grad_norm': 67982.2890625, 'learning_rate': 9.141308606503852e-05, 'epoch': 3.76}
{'eval_loss': 4.294388771057129, 'eval_runtime': 967.7539, 'eval_samples_per_second': 346.528, 'eval_steps_per_second': 21.658, 'epoch': 3.76}
{'loss': 1.8734, 'grad_norm': 72148.09375, 'learning_rate': 0.0001044730312132689, 'epoch': 4.3}
{'eval_loss': 4.150280475616455, 'eval_runtime': 969.279, 'eval_samples_per_second': 345.983, 'eval_steps_per_second': 21.624, 'epoch': 4.3}
{'loss': 1.8178, 'grad_norm': 68978.8984375, 'learning_rate': 0.00011753297636149927, 'epoch': 4.84}
{'eval_loss': 4.043840408325195, 'eval_runtime': 968.4026, 'eval_samples_per_second': 346.296, 'eval_steps_per_second': 21.644, 'epoch': 4.84}
{'loss': 1.7739, 'grad_norm': 68875.8828125, 'learning_rate': 0.00013059292150972965, 'epoch': 5.37}
{'eval_loss': 3.9582762718200684, 'eval_runtime': 969.9234, 'eval_samples_per_second': 345.753, 'eval_steps_per_second': 21.61, 'epoch': 5.37}
{'loss': 1.7416, 'grad_norm': 74011.2578125, 'learning_rate': 0.00014365286665796002, 'epoch': 5.91}
{'eval_loss': 3.892138957977295, 'eval_runtime': 965.2261, 'eval_samples_per_second': 347.436, 'eval_steps_per_second': 21.715, 'epoch': 5.91}
{'loss': 1.7127, 'grad_norm': 64553.30078125, 'learning_rate': 0.0001567128118061904, 'epoch': 6.45}
{'eval_loss': 3.8355343341827393, 'eval_runtime': 969.4798, 'eval_samples_per_second': 345.911, 'eval_steps_per_second': 21.62, 'epoch': 6.45}
{'loss': 1.6934, 'grad_norm': 64526.25390625, 'learning_rate': 0.00016977275695442078, 'epoch': 6.99}
{'eval_loss': 3.7938528060913086, 'eval_runtime': 970.1296, 'eval_samples_per_second': 345.68, 'eval_steps_per_second': 21.605, 'epoch': 6.99}
{'loss': 1.6717, 'grad_norm': 68591.8125, 'learning_rate': 0.00018283270210265115, 'epoch': 7.52}
{'eval_loss': 3.7620770931243896, 'eval_runtime': 960.8659, 'eval_samples_per_second': 349.012, 'eval_steps_per_second': 21.814, 'epoch': 7.52}
{'loss': 1.6614, 'grad_norm': 72739.4296875, 'learning_rate': 0.00019589264725088153, 'epoch': 8.06}
{'eval_loss': 3.7342710494995117, 'eval_runtime': 967.9395, 'eval_samples_per_second': 346.462, 'eval_steps_per_second': 21.654, 'epoch': 8.06}
{'loss': 1.648, 'grad_norm': 64732.14453125, 'learning_rate': 0.0002089525923991119, 'epoch': 8.6}
{'eval_loss': 3.709517002105713, 'eval_runtime': 973.7171, 'eval_samples_per_second': 344.406, 'eval_steps_per_second': 21.526, 'epoch': 8.6}
{'loss': 1.6396, 'grad_norm': 65767.8046875, 'learning_rate': 0.0002220125375473423, 'epoch': 9.13}
{'eval_loss': 3.691336154937744, 'eval_runtime': 967.8019, 'eval_samples_per_second': 346.511, 'eval_steps_per_second': 21.657, 'epoch': 9.13}
{'loss': 1.6324, 'grad_norm': 66013.3515625, 'learning_rate': 0.00023507248269557266, 'epoch': 9.67}
{'eval_loss': 3.677485227584839, 'eval_runtime': 964.2186, 'eval_samples_per_second': 347.799, 'eval_steps_per_second': 21.738, 'epoch': 9.67}
{'loss': 1.6249, 'grad_norm': 64904.640625, 'learning_rate': 0.000248132427843803, 'epoch': 10.21}
{'eval_loss': 3.670043706893921, 'eval_runtime': 964.123, 'eval_samples_per_second': 347.833, 'eval_steps_per_second': 21.74, 'epoch': 10.21}
{'loss': 1.6218, 'grad_norm': 72356.6875, 'learning_rate': 0.0002611923729920334, 'epoch': 10.75}
{'eval_loss': 3.661721706390381, 'eval_runtime': 971.9902, 'eval_samples_per_second': 345.018, 'eval_steps_per_second': 21.564, 'epoch': 10.75}
{'loss': 1.6168, 'grad_norm': 72556.578125, 'learning_rate': 0.0002742523181402638, 'epoch': 11.28}
{'eval_loss': 3.654700994491577, 'eval_runtime': 965.8342, 'eval_samples_per_second': 347.217, 'eval_steps_per_second': 21.701, 'epoch': 11.28}
{'loss': 1.6172, 'grad_norm': 68840.1484375, 'learning_rate': 0.00028731226328849416, 'epoch': 11.82}
{'eval_loss': 3.650853395462036, 'eval_runtime': 970.2944, 'eval_samples_per_second': 345.621, 'eval_steps_per_second': 21.602, 'epoch': 11.82}
{'loss': 1.6119, 'grad_norm': 74012.8359375, 'learning_rate': 0.00030037220843672456, 'epoch': 12.36}
{'eval_loss': 3.6509647369384766, 'eval_runtime': 964.4969, 'eval_samples_per_second': 347.698, 'eval_steps_per_second': 21.732, 'epoch': 12.36}
{'loss': 1.6145, 'grad_norm': 73391.4921875, 'learning_rate': 0.0003134321535849549, 'epoch': 12.9}
{'eval_loss': 3.649444580078125, 'eval_runtime': 959.6843, 'eval_samples_per_second': 349.442, 'eval_steps_per_second': 21.841, 'epoch': 12.9}
{'loss': 1.6099, 'grad_norm': 75959.59375, 'learning_rate': 0.0003264920987331853, 'epoch': 13.43}
{'eval_loss': 3.647056818008423, 'eval_runtime': 972.7112, 'eval_samples_per_second': 344.762, 'eval_steps_per_second': 21.548, 'epoch': 13.43}
{'loss': 1.6141, 'grad_norm': 71440.8515625, 'learning_rate': 0.00033955204388141566, 'epoch': 13.97}
{'eval_loss': 3.6497998237609863, 'eval_runtime': 969.7761, 'eval_samples_per_second': 345.806, 'eval_steps_per_second': 21.613, 'epoch': 13.97}
{'loss': 1.6101, 'grad_norm': 75169.671875, 'learning_rate': 0.000352611989029646, 'epoch': 14.51}
{'eval_loss': 3.6492650508880615, 'eval_runtime': 969.7525, 'eval_samples_per_second': 345.814, 'eval_steps_per_second': 21.614, 'epoch': 14.51}
{'loss': 1.6145, 'grad_norm': 76876.8515625, 'learning_rate': 0.0003656719341778764, 'epoch': 15.05}
{'eval_loss': 3.6527676582336426, 'eval_runtime': 971.0396, 'eval_samples_per_second': 345.356, 'eval_steps_per_second': 21.585, 'epoch': 15.05}
{'loss': 1.6111, 'grad_norm': 72021.46875, 'learning_rate': 0.0003787318793261068, 'epoch': 15.58}
{'eval_loss': 3.653959274291992, 'eval_runtime': 969.9176, 'eval_samples_per_second': 345.755, 'eval_steps_per_second': 21.61, 'epoch': 15.58}
{'loss': 1.6152, 'grad_norm': 77042.171875, 'learning_rate': 0.00039179182447433717, 'epoch': 16.12}
{'eval_loss': 3.6565141677856445, 'eval_runtime': 958.6774, 'eval_samples_per_second': 349.809, 'eval_steps_per_second': 21.863, 'epoch': 16.12}
{'loss': 1.6145, 'grad_norm': 75979.96875, 'learning_rate': 0.00040485176962256757, 'epoch': 16.66}
{'eval_loss': 3.6598880290985107, 'eval_runtime': 966.4044, 'eval_samples_per_second': 347.012, 'eval_steps_per_second': 21.689, 'epoch': 16.66}
{'loss': 1.6157, 'grad_norm': 76158.1796875, 'learning_rate': 0.0004179117147707979, 'epoch': 17.2}
{'eval_loss': 3.660614490509033, 'eval_runtime': 968.8179, 'eval_samples_per_second': 346.148, 'eval_steps_per_second': 21.635, 'epoch': 17.2}
{'loss': 1.617, 'grad_norm': 78402.1484375, 'learning_rate': 0.00043097165991902827, 'epoch': 17.73}
{'eval_loss': 3.6627583503723145, 'eval_runtime': 964.1423, 'eval_samples_per_second': 347.826, 'eval_steps_per_second': 21.74, 'epoch': 17.73}
{'loss': 1.617, 'grad_norm': 74337.5625, 'learning_rate': 0.00044403160506725867, 'epoch': 18.27}
{'eval_loss': 3.6652612686157227, 'eval_runtime': 965.9331, 'eval_samples_per_second': 347.181, 'eval_steps_per_second': 21.699, 'epoch': 18.27}
{'loss': 1.6201, 'grad_norm': 106700.625, 'learning_rate': 0.000457091550215489, 'epoch': 18.81}
{'eval_loss': 3.6677403450012207, 'eval_runtime': 965.9631, 'eval_samples_per_second': 347.171, 'eval_steps_per_second': 21.699, 'epoch': 18.81}
{'loss': 1.6175, 'grad_norm': 79982.0546875, 'learning_rate': 0.0004701514953637195, 'epoch': 19.34}
{'eval_loss': 3.6681511402130127, 'eval_runtime': 968.1168, 'eval_samples_per_second': 346.398, 'eval_steps_per_second': 21.65, 'epoch': 19.34}
{'loss': 1.6228, 'grad_norm': 80716.875, 'learning_rate': 0.0004832114405119498, 'epoch': 19.88}
{'eval_loss': 3.673190116882324, 'eval_runtime': 958.0592, 'eval_samples_per_second': 350.035, 'eval_steps_per_second': 21.878, 'epoch': 19.88}
{'loss': 1.6188, 'grad_norm': 82354.75, 'learning_rate': 0.0004962713856601802, 'epoch': 20.42}
{'eval_loss': 3.6737685203552246, 'eval_runtime': 963.6078, 'eval_samples_per_second': 348.019, 'eval_steps_per_second': 21.752, 'epoch': 20.42}
{'loss': 1.6243, 'grad_norm': 80297.921875, 'learning_rate': 0.0005093313308084105, 'epoch': 20.96}
{'eval_loss': 3.6781702041625977, 'eval_runtime': 965.5073, 'eval_samples_per_second': 347.335, 'eval_steps_per_second': 21.709, 'epoch': 20.96}
{'loss': 1.6198, 'grad_norm': 75740.0859375, 'learning_rate': 0.0005223912759566409, 'epoch': 21.49}
{'eval_loss': 3.6771140098571777, 'eval_runtime': 968.7451, 'eval_samples_per_second': 346.174, 'eval_steps_per_second': 21.636, 'epoch': 21.49}
{'loss': 1.6249, 'grad_norm': 76644.03125, 'learning_rate': 0.0005354512211048713, 'epoch': 22.03}
{'eval_loss': 3.6789844036102295, 'eval_runtime': 967.7276, 'eval_samples_per_second': 346.538, 'eval_steps_per_second': 21.659, 'epoch': 22.03}
{'loss': 1.6206, 'grad_norm': 77095.25, 'learning_rate': 0.0005485111662531017, 'epoch': 22.57}
{'eval_loss': 3.679685115814209, 'eval_runtime': 952.3394, 'eval_samples_per_second': 352.137, 'eval_steps_per_second': 22.009, 'epoch': 22.57}
{'loss': 1.6244, 'grad_norm': 77806.6328125, 'learning_rate': 0.0005615711114013321, 'epoch': 23.11}
{'eval_loss': 3.683666467666626, 'eval_runtime': 970.8463, 'eval_samples_per_second': 345.424, 'eval_steps_per_second': 21.589, 'epoch': 23.11}
{'loss': 1.6235, 'grad_norm': 72639.3359375, 'learning_rate': 0.0005746310565495625, 'epoch': 23.64}
{'eval_loss': 3.6835196018218994, 'eval_runtime': 975.2773, 'eval_samples_per_second': 343.855, 'eval_steps_per_second': 21.491, 'epoch': 23.64}
{'loss': 1.6239, 'grad_norm': 68730.8828125, 'learning_rate': 0.0005876910016977928, 'epoch': 24.18}
{'eval_loss': 3.685356855392456, 'eval_runtime': 968.2492, 'eval_samples_per_second': 346.351, 'eval_steps_per_second': 21.647, 'epoch': 24.18}
{'train_runtime': 69683.2794, 'train_samples_per_second': 1012.681, 'train_steps_per_second': 1.319, 'train_loss': 1.7782171887009628, 'epoch': 24.69}
Data from this directory : data/training_data/guacamol_and_moses_canonical.csv
Tokenizer from this directory : data/tokenizersBEP/guacamol_and_moses_canonical
log files are in this directory : reports/logs/guacamol_and_moses_canonical_BEP/1
Model and checkpoint of training has been save in this directory : models/trained_both_canonical_BEP/1
END OF train.py
